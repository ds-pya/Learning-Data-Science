package com.example.lockguide.launch

import android.content.Context
import android.content.Intent
import android.net.Uri
import com.example.lockguide.ui.Choice

object LaunchTarget {
    fun launch(ctx: Context, choice: Choice) {
        val q = when (choice) {
            Choice.CAR -> "강남역"
            Choice.TRANSIT -> "강남역 대중교통"
            Choice.TAXI -> "강남역 택시"
        }

        val uri = Uri.parse("geo:0,0?q=${Uri.encode(q)}")

        val primary = Intent(Intent.ACTION_VIEW, uri).apply {
            setPackage("com.google.android.apps.maps")
            addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
        }

        runCatching { ctx.startActivity(primary) }
            .onFailure {
                val fallback = Intent(Intent.ACTION_VIEW, uri).apply {
                    addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
                }
                ctx.startActivity(fallback)
            }
    }
}