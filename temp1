import android.content.Context
import android.os.Environment
import java.io.File
import java.io.FileOutputStream

// 이미 위에서 얻었다고 가정:
// val bitmap = getScreenshot(...)
// val treeText = getTreeText(...)
// val allText = getAllText(...)

private fun saveArtifacts(
    context: Context,
    tsFolder: String,          // "yyyyMMdd_HHmmss_SSS" 같은 폴더명
    bitmap: android.graphics.Bitmap?,
    treeText: String,
    allText: String,
    jpegQuality: Int = 80
): Triple<String?, String?, String?> {

    val baseDir = File(context.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), "contextlens")
    val dir = File(baseDir, tsFolder).apply { mkdirs() }

    val shotPath = bitmap?.let {
        val f = File(dir, "screenshot.jpg")
        FileOutputStream(f).use { os -> it.compress(android.graphics.Bitmap.CompressFormat.JPEG, jpegQuality, os) }
        f.absolutePath
    }

    val treePath = File(dir, "layoutdump.txt").apply { writeText(treeText) }.absolutePath
    val textPath = File(dir, "totaltext.txt").apply { writeText(allText) }.absolutePath

    return Triple(shotPath, treePath, textPath)
}