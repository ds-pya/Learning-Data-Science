class StmBatchCounter(
    private val batchSize: Int = 3   // k개 쌓이면 요약
) {
    private val counts = mutableMapOf<Long, Int>()

    /** 
     * @return true면 요약 실행
     */
    fun onFourwAssigned(stmId: Long): Boolean {
        val c = (counts[stmId] ?: 0) + 1
        counts[stmId] = c
        return c >= batchSize
    }

    fun onSummarized(stmId: Long) {
        counts[stmId] = 0
    }

    fun clear(stmId: Long) {
        counts.remove(stmId)
    }
}